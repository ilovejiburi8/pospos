<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>テーブル更新中...</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script>
    (function() {
      // ★ あなたの GAS WebアプリURL に置き換えてください
      // 例: https://script.google.com/macros/s/xxxxxxxxxxxxxxxxx/exec
      const GAS_ENDPOINT = 'https://script.google.com/macros/s/AKfycbzP5EvjjBAUqifTrlaqWHrlNOMpZPla219FeHNQ5vrxneo0-2SFU6d2XGG_EC_0em1q/exec?';

      // ★ AppSheet側の遷移先URL
      const APPSHEET_BASE = 'https://www.appsheet.com/start/32751f13-1acd-4d48-b973-8254b9d92a59';

      // URLパラメータから tableId を取得（例：?tableId=table1）
      const params = new URLSearchParams(window.location.search);
      const tableId = params.get('tableId');

      if (!tableId) {
        document.addEventListener('DOMContentLoaded', function() {
          document.getElementById('msg').textContent =
            'tableId がURLに指定されていません。（例：?tableId=table1）';
        });
        return;
      }

      document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('msg').textContent =
          'テーブル [' + tableId + '] の更新日時を記録しています...';
      });

      // 1) GASを透明な画像リクエストで叩く
      const img = new Image();
      img.src = GAS_ENDPOINT + '?tableId=' + encodeURIComponent(tableId);

      // 2) 少し待ってから AppSheet に飛ばす
      setTimeout(function() {
        const url = APPSHEET_BASE;
        window.location.href = url;
      }, 500);
    })();
  </script>
</head>
<body style="font-family: system-ui;">
  <p id="msg">読み込み中...</p>
</body>
</html>
